{% load static %}

{% block head_comment %}{% endblock %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    {% block headblock %}{% endblock %}
    <link rel="stylesheet" type="text/css" href="{% static 'budgetdb/style.css' %}">
    <title>{% block title %}My Mess of a Budget App{% endblock %}</title>

</head>

<body>
    <div id="content">
        {% block content %}{% endblock %}
    </div>

    <div id="navtools">
        {% block navtools %}
        <ul class="nav">
            <li><a href="{% url 'budgetdb:home' %}">Home</a></li>
            <li><a href="#">Config </a>
                <ul>
                    <li><a href="{% url 'budgetdb:list_account' %}">Accounts</a>
                        <ul id="accounts">
                        </ul>
                    </li>   
                    <li><a href="">Account Hosts</a></li>
                    <li><a href="{% url 'budgetdb:list_cat' %}">Categories</a></li>
                    <li><a href="{% url 'budgetdb:list_be' %}">Recurring Events</a></li>
                </ul>
            </li>
            <li><a href="#">Transactions</a>
                <ul>
                    <li><a href="{% url 'budgetdb:list_transaction' %}">All transaction</a></li>
                    <li><a href="#">Transactions per account</a>
                        <ul>
                            <li><a href="{% url 'budgetdb:list_account_activity' 1 %}">Cheque</a></li>
                            <li><a href="{% url 'budgetdb:list_account_activity' 2 %}">Marge</a></li>
                        </ul>
                    </li>
                    <li><a href="{% url 'budgetdb:calendar_transaction' %}">Calendar</a></li>
                </ul>
            </li>
            <li><a href="#">Charts</a>
                <ul>
                    <li><a href="">Budget Bar</a></li>
                    <li><a href="">Budget Pie</a></li>
                    <li><a href="{% url 'budgetdb:line_chart' %}">Timeline</a></li>
                </ul>
            </li>
            {% if user.is_authenticated %}
            <li><a href="/admin"> {{ user.get_username }}</a>
                <ul>
                    <li><a href="">Preferences</a></li>
                    <li><a href="">Logout</a></li>
                </ul>
            </li>
            {% else %}
            <li><a href="/admin">Please Login</a></li>
            {% endif %}
        </ul>    
        {% endblock %}
    </div>

    <div id="footer">
        {% block footer %}{% endblock %}
    </div>

    <div id="script">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script>
        $(document).ready(function(){
            $.getJSON('{% url "budgetdb:account_list_json" %}', function(result){
              $.each(result, function(i, field){
                var newLi = document.createElement('li');
                var newA = document.createElement('a');
                newA.setAttribute('href','{% url "budgetdb:list_account" %}'+field[0].pk);
                newA.innerHTML = field[1].name;
                newLi.append(newA)
                document.getElementById('accounts').append(newLi);
              });
            });
        });
        </script>

        {% block script %}{% endblock %}
    </div>
</body>
</html>