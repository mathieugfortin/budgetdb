django 101
https://docs.djangoproject.com/en/3.1/intro/tutorial01/
https://code.visualstudio.com/docs/python/tutorial-django#_work-with-data-data-models-and-migrations
https://developer.mozilla.org/en-US/docs/Learn/Server-side/Django/Generic_views

# Don't forget to filter out results depending on the visitor !

autocomplete:
https://django-autocomplete-light.readthedocs.io/en/master/tutorial.html#filtering-results-based-on-the-value-of-other-fields-in-the-form)

add-another
https://github.com/jonashaag/django-addanother

crispy bootstrap
https://simpleisbetterthancomplex.com/tutorial/2018/08/13/how-to-use-bootstrap-4-forms-with-django.html

using DB views in Django
https://resources.rescale.com/using-database-views-in-django-orm/

Django Calendar
https://www.huiwenteo.com/normal/2018/07/24/django-calendar.html
https://www.huiwenteo.com/normal/2018/07/29/django-calendar-ii.html

git 101
https://rogerdudler.github.io/git-guide/

I can't believe google gave me such a hard time finding this...
https://realpython.com/python-f-strings/

subcategories dropdown
https://simpleisbetterthancomplex.com/tutorial/2018/01/29/how-to-implement-dependent-or-chained-dropdown-list-with-django.html

chart js onclick
https://jsfiddle.net/u1szh96g/208/

jquery versions hash
https://code.jquery.com/jquery/

bootstrap ref
https://getbootstrap.com/docs/4.1

vertical line in line chart
https://stackoverflow.com/questions/30256695/chart-js-drawing-an-arbitrary-vertical-line

modelformset_factory with crispy:
https://dev.to/zxenia/django-inline-formsets-with-class-based-views-and-crispy-forms-14o6

to get formset errors: formset.errors.....

Get current user
https://django-crum.readthedocs.io/en/latest/


icones:
https://fonts.google.com/icons

https://stackoverflow.com/questions/30067767/how-do-i-collapse-sections-of-code-in-visual-studio-code-for-windows
collapse: Ctrl-k-1
expand Ctrl-k-j


debug form post
    def form_invalid(self, form):
        a = 1
        # form.errors
        return super().form_invalid(form)

    def clean(self, value):
        a = 1
        return super().clean(form)

debug js: just add "debugger;" in the script where you want a breakpoint

class visually-hidden
httpx:
https://testdriven.io/blog/django-async-views/
https://enzircle.com/responsive-table-with-django-and-htmx


    "pylint.args": [

        "--disable=all",
        "--enable=F,E,unreachable,duplicate-key,unnecessary-semicolon,global-variable-not-assigned,unused-variable,binary-op-exception,bad-format-string,anomalous-backslash-in-string,bad-open-mode",
        "--django-settings-module=web_budget.settings",
    ],    


create docker template for unraid:
https://forums.unraid.net/topic/57181-docker-faq/#comment-566084







def balance_by_EOD(self, dateCheck):
    # 1. Get the most recent Audit for THIS account
    parentAudit = Transaction.view_objects.filter(
        account_source_id=self.pk, 
        date_actual__lte=dateCheck, 
        audit=True
    ).order_by('-date_actual').first()

    childrens = self.account_children.all()
    
    # 2. If there are children, we need to compare dates
    if childrens.exists():
        # Get the most recent Audit date among all children
        # We look for the max date of any audit in the child network
        latest_child_audit_date = Transaction.view_objects.filter(
            account_source__in=childrens,
            date_actual__lte=dateCheck,
            audit=True
        ).aggregate(models.Max('date_actual'))['date_actual__max']

        # LOGIC: Only use children if they have an audit MORE RECENT than the parent
        # or if the parent has no audit at all.
        if latest_child_audit_date:
            if not parentAudit or latest_child_audit_date > parentAudit.date_actual:
                child_balance = Decimal('0.00')
                for child in childrens:
                    child_balance += child.balance_by_EOD(dateCheck)
                return child_balance

    # 3. If no children, or Parent Audit is more recent/equal, use Parent Logic
    if parentAudit:
        if parentAudit.date_actual == dateCheck:
            return parentAudit.amount_actual
        
        balance = Decimal(parentAudit.amount_actual)
        events = Transaction.view_objects.filter(
            date_actual__gt=parentAudit.date_actual, 
            date_actual__lte=dateCheck
        )
    else:
        balance = Decimal(0.00)
        events = Transaction.view_objects.filter(date_actual__lte=dateCheck)

    # Filter events relevant to this specific account
    events = events.filter(Q(account_source_id=self.pk) | Q(account_destination_id=self.pk))

    for event in events:
        if event.audit:
            balance = event.amount_actual
        elif not (event.budget_only and event.date_actual <= date.today()):
            if event.account_destination_id == self.pk:
                balance += event.amount_actual
            if event.account_source_id == self.pk:
                balance -= event.amount_actual

    return balance